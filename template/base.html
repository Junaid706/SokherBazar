<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}SokherBazar{% endblock %}</title>

  <!-- Tailwind (Play CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#D35400',
            secondary: '#27AE60',
            accent: '#E67E22',
            dark: '#2C3E50'
          }
        }
      }
    }
  </script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Optional: your legacy CSS variables (kept for color refs) -->
  <style>
    :root{
      --primary:#D35400;--secondary:#27AE60;--accent:#E67E22;--light:#FEF5E7;
      --dark:#2C3E50;--text:#333;--text-light:#777;--white:#fff;
    }
  </style>

  {% block extra_css %}{% endblock %}
</head>
<body class="text-[#333] bg-white">

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white shadow">
    <div class=" mx-auto px-4 sm:px-6 lg:px-[250px] py-3 flex items-center justify-between">
      <!-- Logo -->
      <a href="{% url 'home' %}" class="flex items-center gap-3">
        <div class="w-11 h-11 rounded-full bg-gradient-to-br from-primary to-accent text-white grid place-items-center font-bold">SB</div>
        <div class="text-2xl font-bold text-primary">SokherBazar</div>
      </a>

      <!-- Nav -->
      <ul class="hidden md:flex items-center gap-6 text-[15px]">
        <li class="{% if request.resolver_match.url_name == 'home' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'home' %}">Home</a>
        </li>
        <li class="{% if request.resolver_match.url_name in 'product_list product_list_by_category product_detail' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'product_list' %}">Products</a>
        </li>
        <li class="{% if request.resolver_match.url_name == 'artisans' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'artisans' %}">Artisans</a>
        </li>
        <li class="{% if request.resolver_match.url_name == 'stories' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'stories' %}">Stories</a>
        </li>
        <li class="{% if request.resolver_match.url_name == 'contact' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'contact' %}">Contact</a>
        </li>
        <li class="{% if request.resolver_match.url_name == 'about' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'about' %}">About</a>
        </li>
        <li class="{% if request.resolver_match.url_name == 'faq' %}text-primary font-semibold{% endif %}">
          <a class="hover:text-primary" href="{% url 'faq' %}">FAQs</a>
        </li>
      </ul>

      <!-- Actions -->
      <div class="flex items-center gap-4">
        <!-- Search -->
        <form method="GET" action="{% url 'product_list' %}" onsubmit="return checkSearch(this);" class="hidden sm:flex">
          <input type="text" name="q"
                 placeholder="Search..."
                 value="{{ request.GET.q|default:'' }}"
                 class="h-10 px-3 rounded-l-lg border border-gray-200 outline-none focus:ring-2 focus:ring-primary" />
          <button type="submit" class="h-10 px-3 rounded-r-lg bg-primary text-white hover:bg-orange-600">
            <i class="fas fa-search"></i>
          </button>
        </form>

        <!-- Cart (only for logged-in users) -->
        {% if request.user.is_authenticated %}
          <a href="{% url 'cart_detail' %}" class="relative inline-flex items-center justify-center w-10 h-10 rounded-full border border-gray-200 hover:bg-gray-50">
            <i class="fas fa-shopping-cart text-[15px]"></i>
            {% if cart_count and cart_count > 0 %}
              <span class="absolute -top-1 -right-1 min-w-[20px] h-[20px] px-1 rounded-full bg-primary text-white text-[11px] grid place-items-center leading-none">
                {{ cart_count }}
              </span>
            {% endif %}
          </a>
        {% endif %}

        <!-- Profile / Login -->
        <div class="relative">
          {% if request.user.is_authenticated %}
            <button id="profileBtn" class="inline-flex items-center gap-2">
              <i class="fas fa-user text-[15px]"></i>
              <span class="hidden sm:inline text-sm font-medium text-[#2C3E50]">
                {{ request.user.first_name|default:request.user.username }}
              </span>
            </button>
            <div id="profileMenu" class="hidden absolute right-0 mt-2 w-44 bg-white border border-gray-200 rounded-lg shadow-lg">
              <a class="block px-4 py-2 hover:bg-gray-50" href="{% url 'profile' %}"><i class="fas fa-user mr-2"></i> My Profile</a>
              <a class="block px-4 py-2 hover:bg-gray-50" href="{% url 'dashboard' %}"><i class="fas fa-store mr-2"></i> Dashboard</a>
              <a class="block px-4 py-2 hover:bg-gray-50" href="{% url 'wishlist' %}"><i class="fas fa-heart mr-2"></i> Wishlist</a>
              <a class="block px-4 py-2 hover:bg-gray-50" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt mr-2"></i> Logout</a>
            </div>
          {% else %}
            <a href="{% url 'login' %}" title="Login / Register" class="inline-flex items-center justify-center w-10 h-10 rounded-full border border-gray-200 hover:bg-gray-50">
              <i class="fas fa-user text-[15px]"></i>
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </header>

  <!-- Flash messages (global) -->
  {% if messages %}
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 mt-4 space-y-2">
      {% for message in messages %}
        {% if message.tags == 'success' %}
          <div class="rounded-lg border border-green-200 bg-green-50 text-green-800 px-4 py-3">{{ message }}</div>
        {% elif message.tags == 'error' or message.tags == 'warning' %}
          <div class="rounded-lg border border-red-200 bg-red-50 text-red-700 px-4 py-3">{{ message }}</div>
        {% else %}
          <div class="rounded-lg border border-gray-200 bg-gray-50 text-gray-700 px-4 py-3">{{ message }}</div>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  <!-- Main Content -->
  <main class="min-h-[60vh]">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-dark text-white mt-10">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 grid gap-8 md:grid-cols-3">
      <div>
        <div class="flex items-center gap-3 mb-3">
          <div class="w-10 h-10 rounded-full bg-gradient-to-br from-primary to-accent text-white grid place-items-center font-bold">SB</div>
          <span class="text-xl font-bold">SokherBazar</span>
        </div>
        <p class="text-white/80">Authentic handmade products from the heart of Bangladesh. Connecting artisans with the world.</p>
      </div>

      <div>
        <h3 class="font-semibold mb-2">Quick Links</h3>
        <ul class="space-y-2 text-white/80">
          <li><a class="hover:text-primary" href="{% url 'about' %}">About Us</a></li>
          <li><a class="hover:text-primary" href="{% url 'register' %}">Become an Artisan</a></li>
          <li><a class="hover:text-primary" href="{% url 'stories' %}">Stories</a></li>
          <li><a class="hover:text-primary" href="{% url 'faq' %}">FAQs</a></li>
        </ul>
      </div>

      <div>
        <h3 class="font-semibold mb-2">Follow Us</h3>
        <div class="flex items-center gap-4 text-xl">
          <a href="#" class="text-white/80 hover:text-primary"><i class="fab fa-facebook-f"></i></a>
          <a href="#" class="text-white/80 hover:text-primary"><i class="fab fa-instagram"></i></a>
          <a href="#" class="text-white/80 hover:text-primary"><i class="fab fa-twitter"></i></a>
          <a href="#" class="text-white/80 hover:text-primary"><i class="fab fa-youtube"></i></a>
        </div>

        <h3 class="font-semibold mt-6 mb-2">Newsletter</h3>
        <form class="flex">
          <input type="email" placeholder="Your email address" class="h-10 px-3 rounded-l-md text-black outline-none" />
          <button type="submit" class="h-10 px-3 rounded-r-md bg-primary hover:bg-orange-600">Subscribe</button>
        </form>
      </div>
    </div>
    <div class="text-center text-white/70 py-4 border-t border-white/10">
      <p>&copy; 2025 SokherBazar. All rights reserved. Made with ❤️ in Bangladesh.</p>
    </div>
  </footer>

  {% block extra_js %}{% endblock %}

  <script>
    function checkSearch(form) {
      const q = form.q.value.trim();
      if (!q) { alert("Please type something to search!"); return false; }
      return true;
    }

    // Profile dropdown
    const btn = document.getElementById('profileBtn');
    const menu = document.getElementById('profileMenu');
    if (btn && menu) {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        menu.classList.toggle('hidden');
      });
      document.addEventListener('click', () => menu.classList.add('hidden'));
    }
  </script>
</body>
</html>
